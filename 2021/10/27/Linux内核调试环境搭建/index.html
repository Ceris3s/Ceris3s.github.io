

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="Cerises">
  <meta name="keywords" content="">
  <meta name="description" content="内核源码下载内核源码下载渠道： （1）git clone 内核，在git checkout某一个分支：git clone https:&#x2F;&#x2F;github.com&#x2F;torvalds&#x2F;linux.git 适用于git commit补丁前的漏洞调试 （2）https:&#x2F;&#x2F;cdn.kernel.org&#x2F;pub&#x2F;linux&#x2F;kernel&#x2F;v4.x&#x2F; 适用于4.x.x版本的内核，下不到更小的发行版 （3）sud">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux内核调试环境搭建">
<meta property="og:url" content="https://ceris3s.github.io/2021/10/27/Linux%E5%86%85%E6%A0%B8%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/index.html">
<meta property="og:site_name" content="blog">
<meta property="og:description" content="内核源码下载内核源码下载渠道： （1）git clone 内核，在git checkout某一个分支：git clone https:&#x2F;&#x2F;github.com&#x2F;torvalds&#x2F;linux.git 适用于git commit补丁前的漏洞调试 （2）https:&#x2F;&#x2F;cdn.kernel.org&#x2F;pub&#x2F;linux&#x2F;kernel&#x2F;v4.x&#x2F; 适用于4.x.x版本的内核，下不到更小的发行版 （3）sud">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-10-27T04:52:57.000Z">
<meta property="article:modified_time" content="2021-12-17T14:52:40.998Z">
<meta property="article:author" content="Cerises">
<meta property="article:tag" content="LinuxKernel">
<meta name="twitter:card" content="summary_large_image">
  
  <title>Linux内核调试环境搭建 - blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"ceris3s.github.io","root":"/","version":"1.8.12","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname"}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.1"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>ceris3s</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Linux内核调试环境搭建">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2021-10-27 12:52" pubdate>
        2021年10月27日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      8.2k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      26 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Linux内核调试环境搭建</h1>
            
            <div class="markdown-body">
              <h2 id="内核源码下载"><a href="#内核源码下载" class="headerlink" title="内核源码下载"></a>内核源码下载</h2><p>内核源码下载渠道：</p>
<p>（1）git clone 内核，在git checkout某一个分支：git clone <a target="_blank" rel="noopener" href="https://github.com/torvalds/linux.git">https://github.com/torvalds/linux.git</a> 适用于git commit补丁前的漏洞调试</p>
<p>（2）<a target="_blank" rel="noopener" href="https://cdn.kernel.org/pub/linux/kernel/v4.x/">https://cdn.kernel.org/pub/linux/kernel/v4.x/</a> 适用于4.x.x版本的内核，下不到更小的发行版</p>
<p>（3）sudo apt-get source linux-image-$(uname -r) 下载当前内核版本或更小的发行版，缺点：版本不全</p>
<p>（4）按下面方式获取ubuntu 发行版源码编译，这样小版本的问题也解决了</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">下载linux kernel源码切换分支<br>查看git仓库地址：https:<span class="hljs-regexp">//</span>wiki.ubuntu.com<span class="hljs-regexp">/Kernel/</span>Dev/KernelGitGuide<br>git clone git:<span class="hljs-regexp">//</span>kernel.ubuntu.com<span class="hljs-regexp">/ubuntu/u</span>buntu-xenial.git<br>git tag | grep <span class="hljs-number">4.4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">21</span><br>git checkout Ubuntu-<span class="hljs-number">4.4</span>.<span class="hljs-number">0</span>-<span class="hljs-number">21.37</span><br></code></pre></td></tr></table></figure>

<p>一般选择方式1，找到漏洞引入的commit，切换过去。或者切到漏洞补丁的commit，然后将补丁手动注释，或者是git checkout patch_commit_id~1，切到补丁的上一个commit</p>
<p>也可以下载<a target="_blank" rel="noopener" href="http://security.ubuntu.com/ubuntu/pool/main/l/linux/">http://security.ubuntu.com/ubuntu/pool/main/l/linux/</a> 中的linux-image-*-*amd64.deb包，解压里面有bzImage，如果能找到对应的vmlinux带符号镜像，那就可以直接调了，不然要想打断点调试，就得编译内核来获取镜像。</p>
<p>国内clone的很慢，可以用清华的源：<a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/help/linux.git/">https://mirrors.tuna.tsinghua.edu.cn/help/linux.git/</a></p>
<p>克隆主线 linux 代码，使用</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">git clone https:<span class="hljs-regexp">//mi</span>rrors.tuna.tsinghua.edu.cn<span class="hljs-regexp">/git/</span>linux.git<br></code></pre></td></tr></table></figure>



<h2 id="linux内核编译"><a href="#linux内核编译" class="headerlink" title="linux内核编译"></a>linux内核编译</h2><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-built_in">make</span> mrproper  <span class="hljs-meta">#清理下</span><br><br><br><span class="hljs-built_in">make</span> defconfig<br><span class="hljs-built_in">make</span> menuconfig<br><span class="hljs-built_in">make</span> -j8<br></code></pre></td></tr></table></figure>

<p>（1）先make defconfig，获取默认的config，这样的config配置少，可以极大提高编译速度，一般几分钟就好了。</p>
<p>（2）make menuconfig：要进行打断点调试，需要关闭系统的随机化和开启调试信息：</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs less"><span class="hljs-selector-tag">Processor</span> <span class="hljs-selector-tag">type</span> <span class="hljs-selector-tag">and</span> <span class="hljs-selector-tag">features</span>  <span class="hljs-selector-tag">---</span>&gt; <br>    <span class="hljs-selector-attr">[ ]</span> <span class="hljs-selector-tag">Build</span> <span class="hljs-selector-tag">a</span> <span class="hljs-selector-tag">relocatable</span> <span class="hljs-selector-tag">kernel</span>                                               <br>        <span class="hljs-selector-attr">[ ]</span>  <span class="hljs-selector-tag">Randomize</span> <span class="hljs-selector-tag">the</span> <span class="hljs-selector-tag">address</span> <span class="hljs-selector-tag">of</span> <span class="hljs-selector-tag">the</span> <span class="hljs-selector-tag">kernel</span> <span class="hljs-selector-tag">image</span> (KASLR) (NEW) <br><br><br><span class="hljs-selector-tag">Kernel</span> <span class="hljs-selector-tag">hacking</span>  <span class="hljs-selector-tag">---</span>&gt;<br>    <span class="hljs-selector-tag">Compile-time</span> <span class="hljs-selector-tag">checks</span> <span class="hljs-selector-tag">and</span> <span class="hljs-selector-tag">compiler</span> <span class="hljs-selector-tag">options</span>  <span class="hljs-selector-tag">---</span>&gt;  <br>        <span class="hljs-selector-attr">[*]</span> <span class="hljs-selector-tag">Compile</span> <span class="hljs-selector-tag">the</span> <span class="hljs-selector-tag">kernel</span> <span class="hljs-selector-tag">with</span> <span class="hljs-selector-tag">debug</span> <span class="hljs-selector-tag">info</span>                                                                  <br>        <span class="hljs-selector-attr">[ ]</span>   <span class="hljs-selector-tag">Reduce</span> <span class="hljs-selector-tag">debugging</span> <span class="hljs-selector-tag">information</span>                                                                      <br>        <span class="hljs-selector-attr">[ ]</span>   <span class="hljs-selector-tag">Produce</span> <span class="hljs-selector-tag">split</span> <span class="hljs-selector-tag">debuginfo</span> <span class="hljs-selector-tag">in</span> <span class="hljs-selector-class">.dwo</span> <span class="hljs-selector-tag">files</span>                                                             <br>        <span class="hljs-selector-attr">[*]</span>   <span class="hljs-selector-tag">Generate</span> <span class="hljs-selector-tag">dwarf4</span> <span class="hljs-selector-tag">debuginfo</span>                                         <br>        <span class="hljs-selector-attr">[*]</span>   <span class="hljs-selector-tag">Provide</span> <span class="hljs-selector-tag">GDB</span> <span class="hljs-selector-tag">scripts</span> <span class="hljs-selector-tag">for</span> <span class="hljs-selector-tag">kernel</span> <span class="hljs-selector-tag">debugging</span>  <br></code></pre></td></tr></table></figure>

<p>以上配置完成后会在当前目录生成 <code>.config</code> 文件，我们可以使用 <code>grep</code> 进行验证：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-comment"># grep CONFIG_DEBUG_INFO .config</span><br>CONFIG_DEBUG_INFO=y<br></code></pre></td></tr></table></figure>

<p>（3）内核编译</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs awk"> $ nproc       <span class="hljs-comment"># 查看当前的系统核数</span><br> $ make -j <span class="hljs-number">8</span>  <span class="hljs-comment"># 或者采用 make bzImage 进行编译， -j N，表示使用多少核并行编译</span><br> <br> <span class="hljs-comment"># 未压缩的内核文件，这个在 gdb 的时候需要加载，用于读取 symbol 符号信息，由于包含调试信息所以比较大</span><br> $ ls -hl vmlinux <br>-rwxr-xr-x <span class="hljs-number">1</span> root root <span class="hljs-number">449</span>M Feb  <span class="hljs-number">3</span> <span class="hljs-number">14</span>:<span class="hljs-number">46</span> vmlinux<br><br><span class="hljs-comment"># 压缩后的镜像文件 </span><br>$ ls -hl .<span class="hljs-regexp">/arch/</span>x86_64<span class="hljs-regexp">/boot/</span>bzImage<br>lrwxrwxrwx <span class="hljs-number">1</span> root root <span class="hljs-number">22</span> Feb  <span class="hljs-number">3</span> <span class="hljs-number">14</span>:<span class="hljs-number">47</span> .<span class="hljs-regexp">/arch/</span>x86_64<span class="hljs-regexp">/boot/</span>bzImage -&gt; ..<span class="hljs-regexp">/../</span>x86<span class="hljs-regexp">/boot/</span>bzImage<br><br>$ ls -hl .<span class="hljs-regexp">/arch/</span>x86<span class="hljs-regexp">/boot/</span>bzImage<br>-rw-r--r-- <span class="hljs-number">1</span> root root <span class="hljs-number">7.6</span>M Feb  <span class="hljs-number">3</span> <span class="hljs-number">14</span>:<span class="hljs-number">47</span> .<span class="hljs-regexp">/arch/</span>x86<span class="hljs-regexp">/boot/</span>bzImage<br></code></pre></td></tr></table></figure>

<p>如果要用到userfaultfd、ebpf的系统调用，需要在编译选项中开启：</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">General setup  <span class="hljs-comment">---&gt;  </span><br>   [*] <span class="hljs-keyword">Enable</span> bpf() <span class="hljs-keyword">system</span> <span class="hljs-keyword">call</span>                                                <br>   [*] <span class="hljs-keyword">Enable</span> userfaultfd() <span class="hljs-keyword">system</span> <span class="hljs-keyword">call</span>     <br></code></pre></td></tr></table></figure>





<h2 id="构建initramfs根文件系统"><a href="#构建initramfs根文件系统" class="headerlink" title="构建initramfs根文件系统"></a>构建initramfs根文件系统</h2><h4 id="什么是initramfs-基于ramfs的临时文件系统"><a href="#什么是initramfs-基于ramfs的临时文件系统" class="headerlink" title="什么是initramfs(基于ramfs的临时文件系统)"></a>什么是initramfs(基于ramfs的临时文件系统)</h4><ul>
<li><p>initramfs 是一种以 cpio 格式压缩后的 rootfs 文件系统，它通常和 Linux 内核文件一起被打包成 boot.img 作为启动镜像</p>
</li>
<li><p>BootLoader 加载 boot.img，并启动内核之后，内核接着就对 cpio 格式的 initramfs 进行解压， 并将解压后得到的 rootfs 加载进内存，最后内核会检查 rootfs 中是否存在 init 可执行文件（该 init 文件本质上是一个执行的 shell 脚本），如果存在，就开始执行 init 程序并创建 Linux 系统用 户空间 PID 为 1 的进程，然后将磁盘中存放根目录内容的分区真正地挂载到 / 根目录上，最后通 过 exec chroot . /sbin/init 命令来将 rootfs 中的根目录切换到挂载了实际磁盘分区文件系统中， 并执行 /sbin/init 程序来启动系统中的其他进程和服务。 基于ramfs开发initramfs，取代了initrd。</p>
</li>
</ul>
<h4 id="什么是initrd"><a href="#什么是initrd" class="headerlink" title="什么是initrd"></a>什么是initrd</h4><ul>
<li><p>initrd代指内核启动过程中的一个阶段，临时挂载文件系统，加载硬盘的基础驱动，进而过渡到最 终的根文件系统 </p>
</li>
<li><p>是早期基于ramdisk生成的临时根文件系统的名称 </p>
</li>
<li><p>现阶段虽然基于initramfs，但是临时根文件系统也依然存在某些发行版称其为initrd </p>
</li>
<li><p>例：CentOS 临时根文件系统命名为 initramfs-<code>uname -r</code>.img Ubuntu 临时根文件系统命名为 initrd-<code>uname -r</code>.img</p>
</li>
</ul>
<h4 id="为什么需要initrd-initramfs"><a href="#为什么需要initrd-initramfs" class="headerlink" title="为什么需要initrd/initramfs"></a>为什么需要initrd/initramfs</h4><ul>
<li><p>Linux kernel在自身初始化完成之后，需要能够找到并运行第一个用户程序（这个程序通常叫 做“init”程序）。用户程序存在于文件系统之中，因此，内核必须找到并挂载一个文件系统才可以 成功完成系统的引导过程。</p>
<p>在grub中提供了一个选项“root=”用来指定第一个文件系统，但随着硬件的发展，很多情况下这个 文件系统也许是存放在USB设备，SCSI设备等等多种多样的设备之上，如果需要正确引导，USB或 者SCSI驱动模块首先需要运行起来，可是不巧的是，这些驱动程序也是存放在文件系统里，因此 会形成一个悖论。</p>
</li>
<li><p>为解决此问题，Linux kernel提出了一个RAM disk的解决方案，把一些启动所必须的用户程序和驱 动模块放在RAM disk中，这个RAM disk看上去和普通的disk一样，有文件系统，有cache，内核 启动时，首先把RAM disk挂载起来，等到init程序和一些必要模块运行起来之后，再切到真正的文 件系统之中。</p>
</li>
<li><p>上面提到的RAM disk的方案实际上就是initrd。 如果仔细考虑一下，initrd虽然解决了问题但并不 完美。 比如，disk有cache机制，对于RAM disk来说，这个cache机制就显得很多余且浪费空间； disk需要文件系统，那文件系统（如ext2等）必须被编译进kernel而不能作为模块来使用。</p>
</li>
<li><p>Linux 2.6 kernel提出了一种新的实现机制，即initramfs。顾名思义，initramfs只是一种RAM filesystem而不是disk。initramfs实际是一个cpio归档，启动所需的用户程序和驱动模块被归档成 一个文件。因此，不需要cache，也不需要文件系统。</p>
</li>
</ul>
<h3 id="制作根文件系统：利用busybox生成根文件系统"><a href="#制作根文件系统：利用busybox生成根文件系统" class="headerlink" title="制作根文件系统：利用busybox生成根文件系统"></a>制作根文件系统：利用busybox生成根文件系统</h3><p>（1）下载busybox</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> ~/oslab<br>wget https://busybox.net/downloads/busybox-1.32.1.tar.bz2 <span class="hljs-comment">#下载 备用链接:  https://od.srpr.cc/acgg0/busybox-1.32.1.tar.bz2</span><br>tar -jxvf busybox-1.32.1.tar.bz2 <span class="hljs-comment">#解压</span><br><span class="hljs-built_in">cd</span> ~/oslab/busybox-1.32.1<br></code></pre></td></tr></table></figure>

<p>（2）编译busybox</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sh">make menuconfig <span class="hljs-comment">#修改配置如下：</span><br></code></pre></td></tr></table></figure>

<p>修改配置如下：(空格键勾选)</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">Settings –&gt;<br><span class="hljs-keyword">Build </span>Options<br>[*] <span class="hljs-keyword">Build </span>static <span class="hljs-keyword">binary（no </span><span class="hljs-keyword">share </span>libs）<br></code></pre></td></tr></table></figure>

<p>编译并安装</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs go"><span class="hljs-built_in">make</span> -j $((<span class="hljs-string">`nproc`</span><span class="hljs-number">-1</span>)<br>sudo <span class="hljs-built_in">make</span> install<br></code></pre></td></tr></table></figure>

<p>（3）准备根文件系统</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> ~/oslab/busybox-1.32.1/_install<br>sudo mkdir dev<br>sudo mknod dev/console c 5 1<br>sudo mknod dev/ram b 1 0<br>sudo touch init<br></code></pre></td></tr></table></figure>

<p>在init中写入以下内容,你可以使用vim或gedit编辑器写入(<a target="_blank" rel="noopener" href="https://www.openvim.com/">vim tutorial</a>)，执行sudo vim init 或 sudo gedit init.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta">#</span><span class="bash">!/bin/sh</span><br>echo &quot;INIT SCRIPT&quot;<br>mkdir /proc<br>mkdir /sys<br>mount -t proc none /proc<br>mount -t sysfs none /sys<br>mkdir /tmp<br>mount -t tmpfs none /tmp<br>echo -e &quot;\nThis boot took $(cut -d&#x27; &#x27; -f1 /proc/uptime) seconds\n&quot;<br>exec /bin/sh<br></code></pre></td></tr></table></figure>

<p>赋予init脚本执行，制作initramfs文件，将x86-busybox下面的内容打包归档成cpio文件，以供 Linux内核做initramfs启动执行</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sh">sudo chmod +x init<br><span class="hljs-built_in">cd</span> ~/oslab/busybox-1.32.1/_install<br>find . -print0 | cpio --null -ov --format=newc | gzip -9 &gt;<br>~/oslab/initramfs-busybox-x64.cpio.gz <span class="hljs-comment"># 注意：该命令一定要在busybox的 _install目录下执行</span><br><span class="hljs-comment"># 注意：每次修改_install,都要重新执行该命令</span><br><span class="hljs-comment">#find . | cpio -o --format=newc &gt; ../rootfs.img</span><br><br></code></pre></td></tr></table></figure>

<p>（4）运行</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs sh"><span class="hljs-built_in">cd</span> ~/oslab<br><span class="hljs-comment">## qemu 以图形界面，弹出窗口形式运行内核</span><br>qemu-system-x86_64 -s -kernel ~/oslab/linux-4.9.263/arch/x86_64/boot/bzImage<br>-initrd ~/oslab/initramfs-busybox-x64.cpio.gz --append <span class="hljs-string">&quot;nokaslr</span><br><span class="hljs-string">root=/dev/ram init=/init&quot;</span><br><br><span class="hljs-comment">## Ubuntu 20.04/20.10 环境下如果出现问题，可执行以下指令 (部分Ubuntu20.04/20.10系统编译linux后bzImage也在x86_64中, 根据实际情况选择bzImage路径)</span><br>qemu-system-x86_64 -s -kernel ~/oslab/linux-4.9.263/arch/x86/boot/bzImage -<br>initrd ~/oslab/initramfs-busybox-x64.cpio.gz --append <span class="hljs-string">&quot;nokaslr root=/dev/ram</span><br><span class="hljs-string">init=/init&quot;</span><br><br><span class="hljs-comment">## 如不希望qemu以图形界面启动，而希望以无界面形式启动，输出重定向到当前shell，使用以下命令</span><br>qemu-system-x86_64 -s -kernel ~/oslab/linux-4.9.263/arch/x86_64/boot/bzImage<br>-initrd ~/oslab/initramfs-busybox-x64.cpio.gz --append <span class="hljs-string">&quot;nokaslr</span><br><span class="hljs-string">root=/dev/ram init=/init console=ttyS0 &quot;</span> -nographic<br></code></pre></td></tr></table></figure>







<h3 id="下载文件系统镜像"><a href="#下载文件系统镜像" class="headerlink" title="下载文件系统镜像"></a>下载文件系统镜像</h3><p>（1）如果漏洞不涉及很多模块，较为简单的就是下载一个ctf kernel pwn的镜像文件，对镜像文件rootfs.img 进行解包修改：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">mkdir core<br>mv rootfs<span class="hljs-selector-class">.img</span> ./core/rootfs<span class="hljs-selector-class">.cpio</span><span class="hljs-selector-class">.gz</span> <br>cd core<br>gunzip rootfs<span class="hljs-selector-class">.cpio</span><span class="hljs-selector-class">.gz</span><br>cpio -idmv &lt; rootfs<span class="hljs-selector-class">.cpio</span><br>rm -rf rootfs.cpio<br></code></pre></td></tr></table></figure>

<p>将漏洞exp放入，再重新打包：</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-builtin-name">find</span> . | cpio -o <span class="hljs-attribute">--format</span>=newc &gt; <span class="hljs-built_in">..</span>/rootfs.img<br></code></pre></td></tr></table></figure>

<p>(2) 涉及较为复杂的模块，如网络，驱动，或者应用层组件，可以获取下面syzkaller的镜像：</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs dsconfig"><span class="hljs-string">sudo</span> <span class="hljs-string">apt-get</span> <span class="hljs-string">install</span> <span class="hljs-string">debootstrap</span><br><span class="hljs-string">wget</span> <span class="hljs-string">https</span>://<span class="hljs-string">raw</span>.<span class="hljs-string">githubusercontent</span>.<span class="hljs-string">com</span>/<span class="hljs-string">google</span>/<span class="hljs-string">syzkaller</span>/<span class="hljs-string">master</span>/<span class="hljs-string">tools</span>/<span class="hljs-built_in">create-image.sh</span> -<span class="hljs-string">O</span> <span class="hljs-built_in">create-image.sh</span><br><span class="hljs-string">chmod</span> +<span class="hljs-string">x</span> <span class="hljs-built_in">create-image.sh</span><br>./<span class="hljs-built_in">create-image.sh</span><br></code></pre></td></tr></table></figure>

<p>上述步骤操作完，已经可以使用scp命令将exp放入镜像中。但也可以自己配置网络上网，下载Exp到系统中：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk">将<span class="hljs-regexp">/etc/</span>network/interfaces中设置成dhcp,将eth0 改成ip addr 显示的网卡:<br>auto eth0<br>iface eth0 inet dhcp<br>重启网络服务:<span class="hljs-regexp">/etc/i</span>nit.d/networking restart<br></code></pre></td></tr></table></figure>

<p>此时qemu可以访问外网，host还不能和qemu通信，所以配置下guest与 host 通信。</p>
<h4 id="配置-guest与-host-通信"><a href="#配置-guest与-host-通信" class="headerlink" title="配置 guest与 host 通信"></a>配置 guest与 host 通信</h4><p>使用tap方式上网：</p>
<p>a、host主机上的配置：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">sudo apt-get <span class="hljs-keyword">install </span>uml-utilities<br>sudo apt-get <span class="hljs-keyword">install </span><span class="hljs-keyword">bridge-utils</span><br><span class="hljs-keyword"></span><br>sudo ifconfig ens33 down              <br>sudo <span class="hljs-keyword">brctl </span><span class="hljs-keyword">addbr </span><span class="hljs-keyword">br0 </span>                     <br>sudo <span class="hljs-keyword">brctl </span><span class="hljs-keyword">addif </span><span class="hljs-keyword">br0 </span>ens33            <br>sudo <span class="hljs-keyword">brctl </span>stp <span class="hljs-keyword">br0 </span>off                 <br>sudo <span class="hljs-keyword">brctl </span>setfd <span class="hljs-keyword">br0 </span><span class="hljs-number">1</span>                 <br>sudo <span class="hljs-keyword">brctl </span>sethello <span class="hljs-keyword">br0 </span><span class="hljs-number">1</span>              <br>sudo ifconfig <span class="hljs-keyword">br0 </span><span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span> promisc up      <br>sudo ifconfig ens33 <span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span> promisc up      <br>sudo dhclient <span class="hljs-keyword">br0</span><br><span class="hljs-keyword"></span>sudo <span class="hljs-keyword">brctl </span><span class="hljs-keyword">show </span><span class="hljs-keyword">br0</span><br><span class="hljs-keyword"></span>sudo <span class="hljs-keyword">brctl </span><span class="hljs-keyword">showstp </span><span class="hljs-keyword">br0</span><br><span class="hljs-keyword"></span><br>sudo ip tuntap <span class="hljs-keyword">add </span>mode tap user $(whoami)<br>sudo tunctl -t tap0 -u root    <br>sudo <span class="hljs-keyword">brctl </span><span class="hljs-keyword">addif </span><span class="hljs-keyword">br0 </span>tap0<br>sudo ifconfig tap0 <span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span><br>sudo <span class="hljs-keyword">brctl </span><span class="hljs-keyword">showstp </span><span class="hljs-keyword">br0</span><br><span class="hljs-keyword"></span><br>删除tap0<br>sudo tunctl -d tap0<br></code></pre></td></tr></table></figure>

<p>b、qemu虚拟机上的配置：</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs awk">设置ssh登陆：<br>sudo vim <span class="hljs-regexp">/etc/</span>pam.d/sshd<br>注释下面两处，运行root和普通用户ssh登陆：<br><br><span class="hljs-comment"># Disallow non-root logins when /etc/nologin exists.</span><br><span class="hljs-comment">#account    required     pam_nologin.so</span><br><br><br><span class="hljs-comment"># Uncomment and edit /etc/security/access.conf if you need to set complex</span><br><span class="hljs-comment"># access limits that are hard to express in sshd_config.</span><br><span class="hljs-comment"># account  required     pam_access.so</span><br><br>sudo <span class="hljs-regexp">/etc/i</span>nit.d/ssh start  <span class="hljs-comment">#启动ssh</span><br></code></pre></td></tr></table></figure>



<h2 id="启动qemu进行漏洞调试"><a href="#启动qemu进行漏洞调试" class="headerlink" title="启动qemu进行漏洞调试"></a>启动qemu进行漏洞调试</h2><p>qemu 启动脚本：</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs livescript">sudo qemu-system-x86_64 <span class="hljs-string">\</span><br>    -m <span class="hljs-number">2</span>G <span class="hljs-string">\</span><br>    -smp <span class="hljs-number">2</span> <span class="hljs-string">\</span><br>    -kernel ./bzImage <span class="hljs-string">\</span><br>    -append <span class="hljs-string">&quot;console=ttyS0 root=/dev/sda earlyprintk=serial&quot;</span><span class="hljs-string">\</span><br>    -drive file=./stretch.img,format=raw <span class="hljs-string">\</span><br>    -net nic <span class="hljs-string">\</span><br>    -net tap,ifname=tap0,script=<span class="hljs-literal">no</span>,downscript=<span class="hljs-literal">no</span> <span class="hljs-string">\</span><br>    -enable-kvm <span class="hljs-string">\</span><br>    -nographic <span class="hljs-string">\</span><br>    -pidfile vm.pid <span class="hljs-string">\</span><br>    <span class="hljs-number">2</span>&gt;&amp;<span class="hljs-number">1</span> | tee vm.log<br></code></pre></td></tr></table></figure>

<p>参数解释：</p>
<p>“smp”指定了处理器的个数；</p>
<p>“m”指定了内存的大小；</p>
<p>“kernel”指定编译生成的内核镜像的存放位置；</p>
<p>“append”是内核启动的附加参数；</p>
<p>“drive”指定之前制作生成的根文件系统的镜像位置；</p>
<p>-nographic：通常，QEMU使用SDL显示VGA输出，使用这个选项，使qemu成为简单的命令行应用程序；</p>
<p><code>-S</code>参数可以让QEMU启动后CPU先Pause住不运行；</p>
<p> <code>-s</code>参数是<code>-gdb tcp::1234</code>的简写，意思是让QEMU侧的gdb server侦听在1234端口等待调试．</p>
<p>由于设置为tap方式，host和qemu在同一个网段里，同时其他host虚拟机也可以进行ssh连接qemu</p>
<p>默认登陆的是root用户，添加sudo 用户：</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">adduser pwn</span><br><span class="hljs-attribute">usermod -aG sudo pwn</span><br></code></pre></td></tr></table></figure>



<figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs vala"><span class="hljs-meta"># 选项说明</span><br><span class="hljs-meta"># -m 指定内存数量</span><br><span class="hljs-meta"># -kernel 指定 bzImage 的镜像路径</span><br><span class="hljs-meta"># -s 等价于 -gdb tcp::1234 表示监听 1234 端口，用于 gdb 连接</span><br><span class="hljs-meta"># -S 表示加载后立即暂停，等待调试指令。不设置这个选项内核会直接执行</span><br><span class="hljs-meta"># -nographic 以及后续的指令用于将输出重新向到当前的终端中，这样就能方便的用滚屏查看内核的输出日志了。</span><br></code></pre></td></tr></table></figure>



<h2 id="GDB-调试"><a href="#GDB-调试" class="headerlink" title="GDB 调试"></a>GDB 调试</h2><p>在使用 <code>qemu-system-x86_64</code> 命令启动内核以后，进入到我们从编译机器上拷贝过来的 Linux 内核源代码目录中，在另外一个终端我们来启动 gdb 命令：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs cmake">[linux-<span class="hljs-number">4.19</span>.<span class="hljs-number">172</span>]$ gdb <br>(gdb) <span class="hljs-keyword">file</span> vmlinux           <span class="hljs-comment"># vmlinux 位于目录 linux-4.19.172 中</span><br>(gdb) <span class="hljs-keyword">target</span> remote :<span class="hljs-number">1234</span><br>(gdb) <span class="hljs-keyword">break</span> start_kernel     <span class="hljs-comment"># 有些文档建议使用 hb 硬件断点，我在本地测试使用 break 也是 ok 的</span><br>(gdb) c   									 <span class="hljs-comment"># 启动调试，则内核会停止在 start_kernel 函数处</span><br></code></pre></td></tr></table></figure>



<h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p><a target="_blank" rel="noopener" href="https://de4dcr0w.github.io/%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AALinux%E5%86%85%E6%A0%B8%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83.html">https://de4dcr0w.github.io/%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AALinux%E5%86%85%E6%A0%B8%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83.html</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/scarecrow_byr/article/details/17741133">https://blog.csdn.net/scarecrow_byr/article/details/17741133</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/google/syzkaller/blob/master/docs/linux/setup_ubuntu-host_qemu-vm_x86-64-kernel.md">https://github.com/google/syzkaller/blob/master/docs/linux/setup_ubuntu-host_qemu-vm_x86-64-kernel.md</a></p>
<p><a target="_blank" rel="noopener" href="https://www.ebpf.top/post/qemu_gdb_busybox_debug_kernel/">https://www.ebpf.top/post/qemu_gdb_busybox_debug_kernel/</a></p>
<p><a target="_blank" rel="noopener" href="https://imkira.com/QEMU-GDB-Linux-Kernel/">https://imkira.com/QEMU-GDB-Linux-Kernel/</a></p>
<p><a target="_blank" rel="noopener" href="http://staff.ustc.edu.cn/~ykli/os2021/lab/lab1.pdf">http://staff.ustc.edu.cn/~ykli/os2021/lab/lab1.pdf</a></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/LinuxKernel/">LinuxKernel</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/LinuxKernel/">LinuxKernel</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/02/20/syzkaller-fuzzing/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Fuzzing linux kernel with syzkaller</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2021/10/24/hello-world/">
                        <span class="hidden-mobile">Hello World</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
